app={site:$("html"),dialMarkup:'<div class="dial"><div class="pointer-x"></div><div class="pointer-y"></div></div>',bg:$(".color-bg"),dialPool:[],init:function(){app.setBgColor(203,50,50);app.addNewDial();app.halfDial=app.dial.width()/2;app.setMoveEvents();app.initAudio()},addNewDial:function(e,t){var n=$(app.dialMarkup);app.dialPool.push(n);app.dial=app.dialPool[0];app.site.append(n)},setBgColor:function(e,t,n){app.bg.css("background-color","hsla("+e+", "+t+"%, "+n+"%, 1)")},setMoveEvents:function(){app.site.on("mousedown",function(e){app.enableMovement(e)});app.site.on("mouseup",function(e){app.disableMovement(e)})},enableMovement:function(e){app.site.on("mousemove",function(e){app.onMove(e)})},disableMovement:function(e){app.currentMovingDial=!1;app.site.off("mousemove")},onMove:function(e){var t=$(e.target);if(t.hasClass("dial")||app.currentMovingDial){app.currentMovingDial=!0;app.updateXY(e.pageX,e.pageY)}},updateXY:function(e,t){var n=e>app.halfDial?e:app.halfDial,r=t>app.halfDial?t:app.halfDial;n>app.site.width()-app.halfDial&&(n=app.site.width()-app.halfDial);r>app.bg.height()-app.halfDial&&(r=app.bg.height()-app.halfDial);TweenMax.to(app.dial,.1,{left:n,top:r});var i=app.dial.offset().left/(app.site.width()-app.halfDial*2),s=app.dial.offset().top/(app.bg.height()-app.halfDial*2);app.setDialHands(i,s);app.setBgColorFromXY(i,s);app.setAudioFromXY(i,s)},setDialHands:function(e,t){var n=e*320-160,r=t*320-160;TweenMax.to($(".pointer-x"),1,{rotation:n,transformOrigin:"47% bottom",ease:Back.easeOut});TweenMax.to($(".pointer-y"),1,{rotation:r,transformOrigin:"47% bottom",ease:Back.easeOut})},setBgColorFromXY:function(e,t){app.setBgColor(353-300*e,100-t*100,50)},oscillator:null,gainNode:null,initAudio:function(){var e=window.AudioContext||window.webkitAudioContext;if(e)var t=new e;else alert("Web Audio API not available");app.oscillator=t.createOscillator();app.gainNode=t.createGainNode();app.gainNode.gain.value=1;app.oscillator.connect(app.gainNode);app.gainNode.connect(t.destination);app.oscillator.frequency.value=440;app.oscillator.type=app.oscillator.SINE;app.oscillator.start(0)},setAudioFromXY:function(e,t){app.oscillator.detune.value=(e-.5)*1e3;app.gainNode.gain.value=1-t}};$(app.init());